<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Tutorial 6 : Keyboard and Mouse</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Free tutorials for modern Opengl (3.3 and later) in C/C++">
    <link rel="canonical" href="http://www.opengl-tutorial.org/beginners-tutorials/tutorial-6-keyboard-and-mouse/">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="Tutorial%206%20%20%20Keyboard%20and%20Mouse_soubory/main.css">
    <link href="Tutorial%206%20%20%20Keyboard%20and%20Mouse_soubory/syntax.css" rel="stylesheet">

    <script async="" src="Tutorial%206%20%20%20Keyboard%20and%20Mouse_soubory/analytics.js"></script><script>

      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-22633480-2', {'siteSpeedSampleRate': 40});
      ga('send', 'pageview');
      
    </script>
    
</head>


    <body>

    
    <header class="site-header">

  <script>
    String.prototype.replaceAt=function(index, character) {
    return this.substr(0, index) + character + this.substr(index+character.length);
    }
    
    function myFunction() {
    var x = document.getElementById("myLanguage").value
    var pageurl = "/beginners-tutorials/tutorial-6-keyboard-and-mouse/"
    if (pageurl.charAt(3) == '/') {
      if(x=='en'){
        pageurl = pageurl.substring(3);
      } else {
        pageurl = pageurl.replaceAt(1, x);
      }
      window.open ('' + pageurl,'_self',false);
    } else { 
      window.open ('/' + x + pageurl,'_self',false);
    }
    
    
    }
  </script>
  
  <div class="wrap">
    
      <a class="site-title" href="http://www.opengl-tutorial.org/">opengl-tutorial</a>
    

    <nav class="site-nav">
      
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path>
        </svg>
      </a>

      <ul class="trigger">
        
        

        <li><a href="http://www.opengl-tutorial.org/beginners-tutorials/">Basic tutorials</a>
          <span class="arrow">▼</span>
          <ul class="sub-menu">
            
            
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                      
                  <li><a href="http://www.opengl-tutorial.org/beginners-tutorials/tutorial-1-opening-a-window/">Tutorial 1 : Opening a window</a></li>
                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                      
                  <li><a href="http://www.opengl-tutorial.org/beginners-tutorials/tutorial-2-the-first-triangle/">Tutorial 2 : The first triangle</a></li>
                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                      
                  <li><a href="http://www.opengl-tutorial.org/beginners-tutorials/tutorial-3-matrices/">Tutorial 3 : Matrices</a></li>
                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                      
                  <li><a href="http://www.opengl-tutorial.org/beginners-tutorials/tutorial-4-a-colored-cube/">Tutorial 4 : A Colored Cube</a></li>
                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                      
                  <li><a href="http://www.opengl-tutorial.org/beginners-tutorials/tutorial-5-a-textured-cube/">Tutorial 5 : A Textured Cube</a></li>
                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                      
                  <li><a href="http://www.opengl-tutorial.org/beginners-tutorials/tutorial-6-keyboard-and-mouse/">Tutorial 6 : Keyboard and Mouse</a></li>
                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                      
                  <li><a href="http://www.opengl-tutorial.org/beginners-tutorials/tutorial-7-model-loading/">Tutorial 7 : Model loading</a></li>
                
              
            
              
              
            
              
              
            
              
              
                
                      
                  <li><a href="http://www.opengl-tutorial.org/beginners-tutorials/tutorial-8-basic-shading/">Tutorial 8 : Basic shading</a></li>
                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
          </ul>
        </li>
        <li><a href="http://www.opengl-tutorial.org/intermediate-tutorials/">Intermediate tutorials</a>
          <span class="arrow">▼</span>
          <ul class="sub-menu">
            
            
            
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    
                  
                  <li><a href="http://www.opengl-tutorial.org/intermediate-tutorials/tutorial-9-vbo-indexing/">Tutorial 9 : VBO Indexing</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/intermediate-tutorials/tutorial-10-transparency/">Tutorial 10 : Transparency</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/intermediate-tutorials/tutorial-11-2d-text/">Tutorial 11 : 2D text</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/intermediate-tutorials/tutorial-12-opengl-extensions/">Tutorial 12 : OpenGL Extensions</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/intermediate-tutorials/tutorial-13-normal-mapping/">Tutorial 13 : Normal Mapping</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/intermediate-tutorials/tutorial-14-render-to-texture/">Tutorial 14 : Render To Texture</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/intermediate-tutorials/tutorial-15-lightmaps/">Tutorial 15 : Lightmaps</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/intermediate-tutorials/tutorial-16-shadow-mapping/">Tutorial 16 : Shadow mapping</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/intermediate-tutorials/tutorial-17-quaternions/">Tutorial 17 : Rotations</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/intermediate-tutorials/billboards-particles/">Tutorial 18 : Billboards &amp; Particles</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    
                    <span class="arrow">▶</span><ul class="sub-menu">
                  
                  <li><a href="http://www.opengl-tutorial.org/intermediate-tutorials/billboards-particles/billboards/">Billboards</a></li>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                  <li><a href="http://www.opengl-tutorial.org/intermediate-tutorials/billboards-particles/particles-instancing/">Particles / Instancing</a></li>

                
              
            
              
              
            
              
              
            
              
              
            
            
              
              </ul></li>
            
          </ul>
        </li>
        <li><a href="http://www.opengl-tutorial.org/miscellaneous/">Miscellaneous</a>
          <span class="arrow">▼</span>
          <ul class="sub-menu">
            
            
            
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    
                  
                  <li><a href="http://www.opengl-tutorial.org/miscellaneous/faq/">FAQ</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/miscellaneous/contribute/">Contribute</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    
                    <span class="arrow">▶</span><ul class="sub-menu">
                  
                  <li><a href="http://www.opengl-tutorial.org/miscellaneous/contribute/translation/">Translation</a></li>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    
                    </ul></li>
                  
                  <li><a href="http://www.opengl-tutorial.org/miscellaneous/math-cheatsheet/">Math Cheatsheet</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/miscellaneous/useful-tools-links/">Useful Tools &amp; Links</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/miscellaneous/an-fps-counter/">An FPS counter</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/miscellaneous/building-your-own-c-application/">Building your own C application</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    </li>
                  
                  <li><a href="http://www.opengl-tutorial.org/miscellaneous/clicking-on-objects/">Clicking on objects</a>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                    
                    <span class="arrow">▶</span><ul class="sub-menu">
                  
                  <li><a href="http://www.opengl-tutorial.org/miscellaneous/clicking-on-objects/picking-with-an-opengl-hack/">Picking with an OpenGL hack</a></li>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                  <li><a href="http://www.opengl-tutorial.org/miscellaneous/clicking-on-objects/picking-with-a-physics-library/">Picking with a physics library</a></li>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
                
                

                  
                  <li><a href="http://www.opengl-tutorial.org/miscellaneous/clicking-on-objects/picking-with-custom-ray-obb-function/">Picking with custom Ray-OBB function</a></li>

                
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
              
              
            
            
              
              </ul></li>
            
          </ul>
        </li>
        <li><a href="http://www.opengl-tutorial.org/download/">Download</a></li>


        <li><select id="myLanguage" onchange="myFunction()">
          
            <option value="en" selected="selected">english</option>	    
          
            <option value="cn">chinese</option>	    
          
            <option value="jp">japanese</option>	    
          
            <option value="ru">russian</option>	    
          
            <option value="fr">français</option>	    
          
	       </select></li>
       </ul>
      </nav></div>
    
  
</header>

    

    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Tutorial 6 : Keyboard and Mouse</h1>
  </header>

  <article class="post-content">
  <p>Welcome for our 6th tutorial !</p>

<p>We will now learn how to use the mouse and the keyboard to move the camera just like in a FPS.</p>

<h1 id="the-interface">The interface</h1>

<p>Since this code will be re-used throughout the tutorials, we will put
 the code in a separate file : common/controls.cpp, and declare the 
functions in common/controls.hpp so that tutorial06.cpp knows about 
them.</p>

<p>The code of tutorial06.cpp doesn’t change much from the previous 
tutorial. The major modification is that instead of computing the MVP 
matrix once, we now have to do it every frame. So let’s move this code 
inside the main loop :</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="k">do</span><span class="p">{</span>

    <span class="c1">// ...
</span>
    <span class="c1">// Compute the MVP matrix from keyboard and mouse input
</span>    <span class="n">computeMatricesFromInputs</span><span class="p">();</span>
    <span class="n">glm</span><span class="o">::</span><span class="n">mat4</span> <span class="n">ProjectionMatrix</span> <span class="o">=</span> <span class="n">getProjectionMatrix</span><span class="p">();</span>
    <span class="n">glm</span><span class="o">::</span><span class="n">mat4</span> <span class="n">ViewMatrix</span> <span class="o">=</span> <span class="n">getViewMatrix</span><span class="p">();</span>
    <span class="n">glm</span><span class="o">::</span><span class="n">mat4</span> <span class="n">ModelMatrix</span> <span class="o">=</span> <span class="n">glm</span><span class="o">::</span><span class="n">mat4</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span>
    <span class="n">glm</span><span class="o">::</span><span class="n">mat4</span> <span class="n">MVP</span> <span class="o">=</span> <span class="n">ProjectionMatrix</span> <span class="o">*</span> <span class="n">ViewMatrix</span> <span class="o">*</span> <span class="n">ModelMatrix</span><span class="p">;</span>

    <span class="c1">// ...
</span><span class="p">}</span>
</code></pre>
</div>

<p>This code needs 3 new functions :</p>

<ul>
  <li>computeMatricesFromInputs() reads the keyboard and mouse and 
computes the Projection and View matrices. This is where all the magic 
happens.</li>
  <li>getProjectionMatrix() just returns the computed Projection matrix.</li>
  <li>getViewMatrix() just returns the computed View matrix.</li>
</ul>

<p>This is just one way to do it, of course. If you don’t like these functions, go ahead and change them.</p>

<p>Let’s see what’s inside controls.cpp.</p>

<h1 id="the-actual-code">The actual code</h1>

<p>We’ll need a few variables.</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="c1">// position
</span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span> <span class="n">position</span> <span class="o">=</span> <span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span> <span class="p">);</span>
<span class="c1">// horizontal angle : toward -Z
</span><span class="kt">float</span> <span class="n">horizontalAngle</span> <span class="o">=</span> <span class="mf">3.14</span><span class="n">f</span><span class="p">;</span>
<span class="c1">// vertical angle : 0, look at the horizon
</span><span class="kt">float</span> <span class="n">verticalAngle</span> <span class="o">=</span> <span class="mf">0.0</span><span class="n">f</span><span class="p">;</span>
<span class="c1">// Initial Field of View
</span><span class="kt">float</span> <span class="n">initialFoV</span> <span class="o">=</span> <span class="mf">45.0</span><span class="n">f</span><span class="p">;</span>

<span class="kt">float</span> <span class="n">speed</span> <span class="o">=</span> <span class="mf">3.0</span><span class="n">f</span><span class="p">;</span> <span class="c1">// 3 units / second
</span><span class="kt">float</span> <span class="n">mouseSpeed</span> <span class="o">=</span> <span class="mf">0.005</span><span class="n">f</span><span class="p">;</span>
</code></pre>
</div>

<p>FoV is the level of zoom. 80° = very wide angle, huge deformations. 60° - 45° : standard. 20° : big zoom.</p>

<p>We will first recompute position, horizontalAngle, verticalAngle and 
FoV according to the inputs, and then compute the View and Projection 
matrices from position, horizontalAngle, verticalAngle and FoV.</p>

<h2 id="orientation">Orientation</h2>

<p>Reading the mouse position is easy :</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="c1">// Get mouse position
</span><span class="kt">int</span> <span class="n">xpos</span><span class="p">,</span> <span class="n">ypos</span><span class="p">;</span>
<span class="n">glfwGetMousePos</span><span class="p">(</span><span class="o">&amp;</span><span class="n">xpos</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ypos</span><span class="p">);</span>
</code></pre>
</div>

<p>but we have to take care to put the cursor back to the center of the 
screen, or it will soon go outside the window and you won’t be able to 
move anymore.</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="c1">// Reset mouse position for next frame
</span><span class="n">glfwSetMousePos</span><span class="p">(</span><span class="mi">1024</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">768</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
</code></pre>
</div>

<p>Notice that this code assumes that the window is 1024*768, which of 
course is not necessarily the case. You can use glfwGetWindowSize if you
 want, too.</p>

<p>We can now compute our viewing angles :</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="c1">// Compute new orientation
</span><span class="n">horizontalAngle</span> <span class="o">+=</span> <span class="n">mouseSpeed</span> <span class="o">*</span> <span class="n">deltaTime</span> <span class="o">*</span> <span class="kt">float</span><span class="p">(</span><span class="mi">1024</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">xpos</span> <span class="p">);</span>
<span class="n">verticalAngle</span>   <span class="o">+=</span> <span class="n">mouseSpeed</span> <span class="o">*</span> <span class="n">deltaTime</span> <span class="o">*</span> <span class="kt">float</span><span class="p">(</span> <span class="mi">768</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">ypos</span> <span class="p">);</span>
</code></pre>
</div>

<p>Let’s read this from right to left :</p>

<ul>
  <li>1024/2 - xpos means : how far is the mouse from the center of the window ? The bigger this value, the more we want to turn.</li>
  <li>float(…) converts it to a floating-point number so that the multiplication goes well.</li>
  <li>mouseSpeed is just there to speed up or slow down the rotations. Fine-tune this at will, or let the user choose it.</li>
  <li>+= : If you didn’t move the mouse, 1024/2-xpos will be 0, and 
horizontalAngle+=0 doesn’t change horizontalAngle. If you had a “=” 
instead, you would be forced back to your original orientation each 
frame, which isn’t good.</li>
</ul>

<p>We can now compute a vector that represents, in World Space, the direction in which we’re looking</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="c1">// Direction : Spherical coordinates to Cartesian coordinates conversion
</span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span> <span class="n">direction</span><span class="p">(</span>
    <span class="n">cos</span><span class="p">(</span><span class="n">verticalAngle</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">horizontalAngle</span><span class="p">),</span>
    <span class="n">sin</span><span class="p">(</span><span class="n">verticalAngle</span><span class="p">),</span>
    <span class="n">cos</span><span class="p">(</span><span class="n">verticalAngle</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">horizontalAngle</span><span class="p">)</span>
<span class="p">);</span>
</code></pre>
</div>

<p>This is a standard computation, but if you don’t know about cosine and sinus, here’s a short explanation :</p>

<p><img class="alignnone whiteborder" title="Trigonometric circle" src="Tutorial%206%20%20%20Keyboard%20and%20Mouse_soubory/trig.gif" alt="" width="150" height="150"></p>

<p>The formula above is just the generalisation to 3D.</p>

<p>Now we want to compute the “up” vector reliably. Notice that “up” 
isn’t always towards +Y : if you look down, for instance, the “up” 
vector will be in fact horizontal. Here is an example of to cameras with
 the same position, the same target, but a different up:</p>

<p><img src="Tutorial%206%20%20%20Keyboard%20and%20Mouse_soubory/CameraUp.png" alt=""></p>

<p>In our case, the only constant is that the vector goes to the right 
of the camera is always horizontal. You can check this by putting your 
arm horizontal, and looking up, down, in any direction. So let’s define 
the “right” vector : its Y coordinate is 0 since it’s horizontal, and 
its X and Z coordinates are just like in the figure above, but with the 
angles rotated by 90°, or Pi/2 radians.</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="c1">// Right vector
</span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span> <span class="n">right</span> <span class="o">=</span> <span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="p">(</span>
    <span class="n">sin</span><span class="p">(</span><span class="n">horizontalAngle</span> <span class="o">-</span> <span class="mf">3.14</span><span class="n">f</span><span class="o">/</span><span class="mf">2.0</span><span class="n">f</span><span class="p">),</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="n">cos</span><span class="p">(</span><span class="n">horizontalAngle</span> <span class="o">-</span> <span class="mf">3.14</span><span class="n">f</span><span class="o">/</span><span class="mf">2.0</span><span class="n">f</span><span class="p">)</span>
<span class="p">);</span>
</code></pre>
</div>

<p>We have a “right” vector and a “direction”, or “front” vector. The 
“up” vector is a vector that is perpendicular to these two. A useful 
mathematical tool makes this very easy : the cross product.</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="c1">// Up vector : perpendicular to both direction and right
</span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span> <span class="n">up</span> <span class="o">=</span> <span class="n">glm</span><span class="o">::</span><span class="n">cross</span><span class="p">(</span> <span class="n">right</span><span class="p">,</span> <span class="n">direction</span> <span class="p">);</span>
</code></pre>
</div>

<p>To remember what the cross product does, it’s very simple. Just 
recall the Right Hand Rule from Tutorial 3. The first vector is the 
thumb; the second is the index; and the result is the middle finger. 
It’s very handy.</p>

<h2 id="position">Position</h2>

<p>The code is pretty straightforward. By the way, I used the 
up/down/right/left keys instead of the awsd because on my azerty 
keyboard, awsd is actually zqsd. And it’s also different with qwerZ 
keyboards, let alone korean keyboards. I don’t even know what layout 
korean people have, but I guess it’s also different.</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="c1">// Move forward
</span><span class="k">if</span> <span class="p">(</span><span class="n">glfwGetKey</span><span class="p">(</span> <span class="n">GLFW_KEY_UP</span> <span class="p">)</span> <span class="o">==</span> <span class="n">GLFW_PRESS</span><span class="p">){</span>
    <span class="n">position</span> <span class="o">+=</span> <span class="n">direction</span> <span class="o">*</span> <span class="n">deltaTime</span> <span class="o">*</span> <span class="n">speed</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// Move backward
</span><span class="k">if</span> <span class="p">(</span><span class="n">glfwGetKey</span><span class="p">(</span> <span class="n">GLFW_KEY_DOWN</span> <span class="p">)</span> <span class="o">==</span> <span class="n">GLFW_PRESS</span><span class="p">){</span>
    <span class="n">position</span> <span class="o">-=</span> <span class="n">direction</span> <span class="o">*</span> <span class="n">deltaTime</span> <span class="o">*</span> <span class="n">speed</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// Strafe right
</span><span class="k">if</span> <span class="p">(</span><span class="n">glfwGetKey</span><span class="p">(</span> <span class="n">GLFW_KEY_RIGHT</span> <span class="p">)</span> <span class="o">==</span> <span class="n">GLFW_PRESS</span><span class="p">){</span>
    <span class="n">position</span> <span class="o">+=</span> <span class="n">right</span> <span class="o">*</span> <span class="n">deltaTime</span> <span class="o">*</span> <span class="n">speed</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// Strafe left
</span><span class="k">if</span> <span class="p">(</span><span class="n">glfwGetKey</span><span class="p">(</span> <span class="n">GLFW_KEY_LEFT</span> <span class="p">)</span> <span class="o">==</span> <span class="n">GLFW_PRESS</span><span class="p">){</span>
    <span class="n">position</span> <span class="o">-=</span> <span class="n">right</span> <span class="o">*</span> <span class="n">deltaTime</span> <span class="o">*</span> <span class="n">speed</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>
</div>

<p>The only special thing here is the deltaTime. You don’t want to move from 1 unit each frame for a simple reason :</p>

<ul>
  <li>If you have a fast computer, and you run at 60 fps, you’d move of 60*speed units in 1 second</li>
  <li>If you have a slow computer, and you run at 20 fps, you’d move of 20*speed units in 1 second</li>
</ul>

<p>Since having a better computer is not an excuse for going faster, you
 have to scale the distance by the “time since the last frame”, or 
“deltaTime”.</p>

<ul>
  <li>If you have a fast computer, and you run at 60 fps, you’d move of 1/60 * speed units in 1 frame, so 1*speed in 1 second.</li>
  <li>If you have a slow computer, and you run at 20 fps, you’d move of 1/20 * speed units in 1 second, so 1*speed in 1 second.</li>
</ul>

<p>which is much better. deltaTime is very simple to compute :</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="kt">double</span> <span class="n">currentTime</span> <span class="o">=</span> <span class="n">glfwGetTime</span><span class="p">();</span>
<span class="kt">float</span> <span class="n">deltaTime</span> <span class="o">=</span> <span class="kt">float</span><span class="p">(</span><span class="n">currentTime</span> <span class="o">-</span> <span class="n">lastTime</span><span class="p">);</span>
</code></pre>
</div>

<h2 id="field-of-view">Field Of View</h2>

<p>For fun, we can also bind the wheel of the mouse to the Field Of View, so that we can have a cheap zoom :</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="kt">float</span> <span class="n">FoV</span> <span class="o">=</span> <span class="n">initialFoV</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">glfwGetMouseWheel</span><span class="p">();</span>
</code></pre>
</div>

<h2 id="computing-the-matrices">Computing the matrices</h2>

<p>Computing the matrices is now straightforward. We use the exact same functions than before, but with our new parameters.</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="c1">// Projection matrix : 45&amp;deg; Field of View, 4:3 ratio, display range : 0.1 unit &lt;-&gt; 100 units
</span><span class="n">ProjectionMatrix</span> <span class="o">=</span> <span class="n">glm</span><span class="o">::</span><span class="n">perspective</span><span class="p">(</span><span class="n">FoV</span><span class="p">,</span> <span class="mf">4.0</span><span class="n">f</span> <span class="o">/</span> <span class="mf">3.0</span><span class="n">f</span><span class="p">,</span> <span class="mf">0.1</span><span class="n">f</span><span class="p">,</span> <span class="mf">100.0</span><span class="n">f</span><span class="p">);</span>
<span class="c1">// Camera matrix
</span><span class="n">ViewMatrix</span>       <span class="o">=</span> <span class="n">glm</span><span class="o">::</span><span class="n">lookAt</span><span class="p">(</span>
    <span class="n">position</span><span class="p">,</span>           <span class="c1">// Camera is here
</span>    <span class="n">position</span><span class="o">+</span><span class="n">direction</span><span class="p">,</span> <span class="c1">// and looks here : at the same position, plus "direction"
</span>    <span class="n">up</span>                  <span class="c1">// Head is up (set to 0,-1,0 to look upside-down)
</span><span class="p">);</span>
</code></pre>
</div>

<h1 id="results">Results</h1>

<p><img src="Tutorial%206%20%20%20Keyboard%20and%20Mouse_soubory/moveanim.gif" alt=""></p>

<h2 id="backface-culling">Backface Culling</h2>

<p>Now that you can freely move around, you’ll notice that if you go 
inside the cube, polygons are still displayed. This can seem obvious, 
but this remark actually opens an opportunity for optimisation. As a 
matter of fact, in a usual application, you are never <em>inside</em> a cube.</p>

<p>The idea is to let the GPU check if the camera is behind, or in front
 of, the triangle. If it’s in front, display the triangle; if it’s 
behind, <em>and</em> the mesh is closed, <em>and</em> we’re not inside the mesh, <em>then</em>
 there will be another triangle in front of it, and nobody will notice 
anything, except that everything will be faster : 2 times less triangles
 on average !</p>

<p>The best thing is that it’s very easy to check this. The GPU computes
 the normal of the triangle (using the cross product, remember ?) and 
checks whether this normal is oriented towards the camera or not.</p>

<p>This comes at a cost, unfortunately : the orientation of the triangle
 is implicit. This means that is you invert two vertices in your buffer,
 you’ll probably end up with a hole. But it’s generally worth the little
 additional work. Often, you just have to click “invert normals” in your
 3D modeler (which will, in fact, invert vertices, and thus normals) and
 everything is just fine.</p>

<p>Enabling backface culling is a breeze :</p>

<div class="language-cpp highlighter-rouge"><pre class="highlight"><code><span class="c1">// Cull triangles which normal is not towards the camera
</span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL_CULL_FACE</span><span class="p">);</span>
</code></pre>
</div>

<h1 id="exercices">Exercices</h1>

<ul>
  <li>Restrict verticalAngle so that you can’t go upside-down</li>
  <li>Create a camera that rotates around the object ( position = 
ObjectCenter + ( radius * cos(time), height, radius * sin(time) ) ); 
bind the radius/height/time to the keyboard/mouse, or whatever</li>
  <li>Have fun !</li>
</ul>


  </article>

</div>
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <div class="footer-col-1 column">
      <ul>
        <li><a href="mailto:contact@opengl-tutorial.org">contact@opengl-tutorial.org</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <a href="https://github.com/opengl-tutorials/ogl" target="_blank">
        <span class="icon github">
          <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
            <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
            c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
            c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
            c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
            C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
            c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
            c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
            c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
            c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"></path>
          </svg>
        </span>
        <span class="username"></span>
      </a>
        
      <a href="https://twitter.com/GraphicsTut" target="_blank">
        <span class="icon twitter">
          <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
            <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
            c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
            c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
            c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
            C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
            c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
            c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"></path>
          </svg>
        </span>
        <span class="username"></span>
      </a>
      <a href="https://plus.google.com/107410003823545892786" target="_blank">
        <span class="icon gplus">
          <svg class="gplus-icon-svg" enable-background="new 0 0 128 128" height="128px" id="Layer_1" version="1.1" viewBox="0 0 128 128" width="128px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink"><g><circle cx="64" cy="64" fill="#C2C2C2" r="64"></circle><g><g><path d="M49.424,97.875c-19.018,0-34.491-15.193-34.491-33.874c0-18.68,15.473-33.875,34.491-33.875     c8.318,0,16.354,2.952,22.624,8.309l-8.771,9.899c-3.838-3.279-8.758-5.086-13.853-5.086c-11.652,0-21.13,9.31-21.13,20.752     c0,11.441,9.479,20.75,21.13,20.75c9.858,0,16.311-4.723,18.407-13.197H49.587V58.432h32.347v6.562     C81.934,84.659,68.869,97.875,49.424,97.875z" fill="#FFFFFF"></path></g><polygon fill="#FFFFFF" points="117.934,58.438 107.934,58.438 107.934,48.438 99.934,48.438 99.934,58.438 89.934,58.438     89.934,66.438 99.934,66.438 99.934,76.438 107.934,76.438 107.934,66.438 117.934,66.438   "></polygon></g></g>
          </svg>
        </span>
      </a>
    </div>

    <div class="footer-col-3 column">
      <p class="text">Free tutorials for modern Opengl (3.3 and later) in C/C++</p>
    </div>

  </div>

</footer>


    
</body></html>